namespace DataStorage
{
    using MySql.Data.MySqlClient;
    using System;
    using System.Collections.Generic;
    using System.Data;

    /// <summary>
    /// Class ElementsFromDatabase.
    /// </summary>
    /// <autogeneratedoc />
    /// TODO Edit XML Comment Template for ElementsFromDatabase
    public static class ElementsFromDatabase
    {
        public static void UpdateAllCheckboxes(string url, Boolean wel, string element, int begin = 0, int eind = 0, int keuze = 0)
        {
            var selecteren = 0;
            if (wel == true)
            {
                selecteren = 1;
            }

            var query = "";


            if (keuze == 1)
            {
                query = "UPDATE selenium_elements ";
                query += "SET " + element + " = " + selecteren;
                query += " WHERE ";

                if (begin > 0)
                {
                    query += " idselenium_elements >= " + begin + " AND ";
                }

                if (eind > 0)
                {
                    query += " idselenium_elements <= " + eind + " AND ";
                }


                query += " url = '" + url + "';";
            }

            if (keuze == 0)
            {
                query = "UPDATE elements_short ";
                query += "SET " + element + " = " + selecteren;
                query += " WHERE ";

                if (begin > 0)
                {
                    query += " id_elements >= " + begin + " AND ";
                }

                if (eind > 0)
                {
                    query += " id_elements <= " + eind + " AND ";
                }

                query += " url = '" + url + "';";
            }

            General.ExecuteQueryCommand(query);
        }

        public static void UpdateAllCheckbox8(string id, Boolean wel, string element, int keuze)
        {
            var selecteren = 0;
            if (wel == true)
            {
                selecteren = 1;
            }

            var query = string.Empty;

            if (keuze == 0)
            {
                query = " UPDATE elements_short ";
                query += "SET " + element + " = " + selecteren;
                query += " WHERE id_elements = '" + id + "';";
            }

            if (keuze == 1)
            {
                query = "UPDATE selenium_elements ";
                query += "SET " + element + " = " + selecteren;
                query += " WHERE idselenium_elements = '" + id + "';";
            }

            General.ExecuteQueryCommand(query);
        }

        public static void UpdateCheckBox8(string id, Boolean wel, int keuze = 0)
        {
            var selecteren = 0;
            if (wel == true)
            {
                selecteren = 1;
            }
            var query = "";

            if (keuze == 1)
            {
                query = "UPDATE selenium_elements ";
                query += "SET checktext = '" + selecteren + "' WHERE idselenium_elements = " + id + ";";

            }
            if (keuze == 0)
            {
                query = "UPDATE elements_short ";
                query += "SET checktext = '" + selecteren + "' WHERE id_elements = " + id + ";";
            }
            General.ExecuteQueryCommand(query);
        }

        public static void UpdateCheckBox(string id, Boolean wel, int keuze = 0)
        {
            var selecteren = 0;
            if (wel == true)
            {
                selecteren = 1;
            }

            var query = string.Empty;
            if (keuze == 1)
            {
                query = "UPDATE selenium_elements ";
                query += "SET selenium_check = '" + selecteren + "' WHERE idselenium_elements = " + id + ";";
            }
            if (keuze == 0)
            {
                query = "UPDATE elements_short ";
                query += "SET selenium_check = '" + selecteren + "' WHERE id_elements = " + id + ";";
            }
            General.ExecuteQueryCommand(query);
        }

        public static void DeleteDataFromDatabase(string url, int keuze = 0)
        {
            var tabel = "elements_short";
            if (keuze == 1)
            {
                tabel = "selenium_elements";
            }
            var query = "DELETE FROM " + tabel + " ";
            query += "WHERE url = '" + url + "' ";
            General.ExecuteQueryCommand(query);
        }

        public static List<NewElements.AllElements> GetDataTable(string url, int keuze)
        {
            var elementresults = new List<NewElements.AllElements>();
            var query = string.Empty;


            if (keuze == 0)
            {
                query = "SELECT id_elements, url, tagname, text, href, id, name, class, xpath, selenium_check, " +
                        "checktext FROM elements_short ";
                query += "WHERE url = '" + url + "' ORDER BY url, id_elements;";
            }

            if (keuze == 1)
            {
                query = "SELECT idselenium_elements, url, tagname, text, href, id, name, class, xpath, selenium_check, " +
                            "checktext FROM selenium_elements ";
                query += "WHERE url = '" + url + "' ORDER BY url, idselenium_elements;";
            }
            var objConn = new MySqlConnection(General.MySqlConnectionString());
            var objDataAdapter = new MySqlDataAdapter(query, objConn);
            var objDataset = new DataSet();
            var boo1 = "0";
            var boo2 = false;
            var boochecktext1 = "0";
            var boochecktext2 = true;
            try
            {
                objConn.Open();
                objDataAdapter.Fill(objDataset, "call_calls123");
                for (var i = 0; i < objDataset.Tables[0].Rows.Count; i++)
                {
                    boo1 = objDataset.Tables[0].Rows[i]["selenium_check"].ToString();
                    boochecktext1 = objDataset.Tables[0].Rows[i]["checktext"].ToString();
                    if (boo1 == "1") boo2 = true;
                    if (boo1 == "0") boo2 = false;
                    if (boochecktext1 == "0") boochecktext2 = false;
                    if (boochecktext1 == "1") boochecktext2 = true;
                    elementresults.Add(
                        new NewElements.AllElements
                        {
                            elementLink = objDataset.Tables[0].Rows[i][1].ToString(),
                            elementTagname = objDataset.Tables[0].Rows[i]["tagname"].ToString(),
                            elementText = objDataset.Tables[0].Rows[i]["text"].ToString(),
                            elementHref = objDataset.Tables[0].Rows[i]["href"].ToString(),
                            elementId = objDataset.Tables[0].Rows[i]["id"].ToString(),
                            elementName = objDataset.Tables[0].Rows[i]["name"].ToString(),
                            elementClass = objDataset.Tables[0].Rows[i]["class"].ToString(),
                            elementXpath = objDataset.Tables[0].Rows[i]["xpath"].ToString(),
                            elementCheck = boo2,
                            elementCheckText = boochecktext2,
                            idSelenium_element = Convert.ToInt32(objDataset.Tables[0].Rows[i][0].ToString())
                        });
                }

                objConn.Close();
            }
            catch (Exception e)
            {
                General.LogMessage(e.Message + "\r\n\r\n" + e.StackTrace + "\r\n\r\n" + e.Source, 4);
            }

            return elementresults;
        }
    }
}