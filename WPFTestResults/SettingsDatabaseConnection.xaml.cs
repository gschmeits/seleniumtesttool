// ***********************************************************************
// Assembly         : WPFTestResults
// Author           : G.H.M.H. Schmeits
// Created          : 03-19-2018
//
// Last Modified By : G.H.M.H. Schmeits
// Last Modified On : 03-28-2018
// ***********************************************************************
// <copyright file="SettingsDatabaseConnection.xaml.cs" company="SCHMEITS">
//     Copyright ©  2018
// </copyright>
// <summary></summary>
// ***********************************************************************

namespace WPFTestResults
{
    using DataStorage;
    using GeneralFunctionality;
    using System.Windows;
    using System.Xml;

    /// <summary>
    /// Interaction logic for SettingsDatabaseConnection.xaml
    /// </summary>
    /// <seealso cref="System.Windows.Window" />
    /// <seealso cref="System.Windows.Markup.IComponentConnector" />
    public partial class SettingsDatabaseConnection : Window
    {
        /// <summary>
        /// Initializes a new instance of the <see cref="SettingsDatabaseConnection" /> class.
        /// </summary>
        /// <autogeneratedoc />
        /// TODO Edit XML Comment Template for #ctor
        public SettingsDatabaseConnection()
        {
            InitializeComponent();

            this.TextBoxHostname.Text = General._databaseConnection.Host;
            this.TextBoxDatabase.Text = General._databaseConnection.Database;
            this.TextBoxUsername.Text = General._databaseConnection.User;
            this.PasswordBoxPassword.Password = General._databaseConnection.Password;
            this.TextBoxPort.Text = General._databaseConnection.Port;
        }

        /// <summary>
        /// Handles the Click event of the ButtonDatabaseConnectionSave control.
        /// </summary>
        /// <param name="sender">The source of the event.</param>
        /// <param name="e">The <see cref="RoutedEventArgs" /> instance containing the event data.</param>
        /// <autogeneratedoc />
        /// TODO Edit XML Comment Template for ButtonDatabaseConnectionSave_Click
        private void ButtonDatabaseConnectionSave_Click(object sender, RoutedEventArgs e)
        {
            General._databaseConnection.Host = this.TextBoxHostname.Text;
            General._databaseConnection.Database = this.TextBoxDatabase.Text;
            General._databaseConnection.User = this.TextBoxUsername.Text;
            General._databaseConnection.Password = this.PasswordBoxPassword.Password;
            General._databaseConnection.Port = this.TextBoxPort.Text;

            using (XmlWriter writer = XmlWriter.Create(Functions.GetCurrentDir(0) + "connect.xml"))
            {
                writer.WriteStartDocument();
                writer.WriteStartElement("settings");
                writer.WriteStartElement("connection");
                writer.WriteElementString("host", this.TextBoxHostname.Text);
                writer.WriteElementString("database", this.TextBoxDatabase.Text);
                writer.WriteElementString("port", this.TextBoxPort.Text);
                writer.WriteElementString("username", this.TextBoxUsername.Text);
                writer.WriteElementString("password", this.PasswordBoxPassword.Password);
                writer.WriteEndElement();
                writer.WriteEndElement();
                writer.WriteEndDocument();
            }

            MessageBox.Show(
                "The database connection settings are saved!!!",
                "Message",
                MessageBoxButton.OK,
                MessageBoxImage.Information);

            this.Close();
        }

        /// <summary>
        /// Handles the Click event of the ButtonDatabaseConnectionCancel control.
        /// </summary>
        /// <param name="sender">The source of the event.</param>
        /// <param name="e">The <see cref="RoutedEventArgs" /> instance containing the event data.</param>
        /// <autogeneratedoc />
        /// TODO Edit XML Comment Template for ButtonDatabaseConnectionCancel_Click
        private void ButtonDatabaseConnectionCancel_Click(object sender, RoutedEventArgs e)
        {
            this.Close();
        }
    }
}